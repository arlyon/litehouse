table inet fw {
    chain input {
        type filter hook input priority 0;

        # allow established/related connections
        ct state {established, related} accept

        # early drop of invalid connections
        ct state invalid drop

        # allow from loopback
        iifname lo accept

        # allow icmp
        ip protocol icmp accept
        ip6 nexthdr icmpv6 accept

        # allow ssh,http
        tcp dport {ssh,http,https} accept

        # everything else
        reject with icmp type port-unreachable
    }
    chain forward {
        type filter hook forward priority 0;
        drop
    }
    chain output {
        type filter hook output priority 0;
    }
}
